<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Books - LMS</title>
  <link rel="stylesheet" href="css/styles.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
  <style>
    :root {
      --navy: #0a2342;
      --navy-dark: #06162a;
      --accent: #1e90ff;
      --white: #fff;
      --light-bg: #f4f8fb;
      --card-shadow: 0 2px 8px rgba(10,35,66,0.08);
    }
    body { background: var(--light-bg); }
    .nav-wrapper { background: var(--navy) !important; }
    .brand-logo { color: var(--white) !important; font-weight: 700; }
    .nav-wrapper ul li a { color: var(--white) !important; font-weight: 500; }
    .nav-wrapper ul li a.active, .nav-wrapper ul li a:focus, .nav-wrapper ul li a:hover {
      background: var(--accent) !important;
      color: var(--white) !important;
      border-radius: 4px;
    }
    .step-card, .card {
      background: var(--white);
      box-shadow: var(--card-shadow);
      border-radius: 12px;
      margin-bottom: 24px;
    }
    .card-title, .step-card .card-title {
      color: var(--navy);
      font-weight: 700;
    }
    .btn, .btn-large, .btn-floating {
      background: var(--accent) !important;
      color: var(--white) !important;
      border-radius: 24px;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(30,144,255,0.08);
      transition: background 0.2s;
    }
    .btn:hover, .btn-large:hover, .btn-floating:hover {
      background: var(--navy) !important;
      color: var(--white) !important;
    }
    .card-panel, .modal-content, .card-content {
      background: var(--white) !important;
      color: var(--navy-dark);
      border-radius: 12px;
    }
    .fixed-action-btn .btn-floating {
      background: var(--accent) !important;
      color: var(--white) !important;
    }
    .modal-content h5 { color: var(--navy); }
    .modal-footer .btn-flat { color: var(--accent) !important; }
    .tooltipped { outline: none; }
    @media (max-width: 600px) {
      .step-card, .card { min-width: 100%; }
      .container { padding: 0 4px; }
    }
  </style>
</head>
<body>
  <nav class="nav-wrapper blue">
    <div class="container">
      <ul id="nav-mobile" class="right hide-on-med-and-down">
        <li><a href="dashboard.html"><i class="material-icons left">dashboard</i>Dashboard</a></li>
        <li><a href="books.html"><i class="material-icons left">menu_book</i>Books</a></li>
        <li><a href="users.html"><i class="material-icons left">group</i>Users</a></li>
        <li><a href="issue_return.html"><i class="material-icons left">assignment_returned</i>Issue/Return</a></li>
        <li><a href="fines.html"><i class="material-icons left">attach_money</i>Fines</a></li>
        <li><a href="reservations.html"><i class="material-icons left">event_available</i>Reservations</a></li>
        <li><a href="ebooks.html"><i class="material-icons left">picture_as_pdf</i>E-Books</a></li>
        <li><a href="profile.html"><i class="material-icons left">person</i>Profile</a></li>
      </ul>
    </div>
  </nav>
  <div class="container" style="margin-top:30px;">
    <div class="row">
      <div class="col s12 m8">
        <div class="card step-card admin-only">
          <div class="card-content">
            <span class="card-title"><i class="material-icons left">add_box</i> Add/Edit Book</span>
            <form id="bookForm">
              <input type="hidden" id="bookId" />
              <div class="input-field">
                <input type="text" id="title" placeholder="Title" required class="tooltipped" data-tooltip="Enter the book title">
                <label for="title">Title <i class="material-icons tiny tooltipped" data-tooltip="Book title">help_outline</i></label>
                <span class="helper-text">E.g., "Introduction to Algorithms"</span>
              </div>
              <div class="input-field">
                <input type="text" id="author" placeholder="Author" required class="tooltipped" data-tooltip="Enter the author's name">
                <label for="author">Author <i class="material-icons tiny tooltipped" data-tooltip="Book author">help_outline</i></label>
                <span class="helper-text">E.g., "Thomas H. Cormen"</span>
              </div>
              <div class="input-field">
                <input type="text" id="isbn" placeholder="ISBN" required class="tooltipped" data-tooltip="Enter the ISBN number">
                <label for="isbn">ISBN <i class="material-icons tiny tooltipped" data-tooltip="Book ISBN">help_outline</i></label>
                <span class="helper-text">E.g., "9780262033848"</span>
              </div>
              <div class="input-field">
                <input type="text" id="genre" placeholder="Genre" required class="tooltipped" data-tooltip="Enter the book genre">
                <label for="genre">Genre <i class="material-icons tiny tooltipped" data-tooltip="Book genre">help_outline</i></label>
                <span class="helper-text">E.g., "Computer Science"</span>
              </div>
              <div class="input-field">
                <input type="number" id="quantity" placeholder="Quantity" required min="1" class="tooltipped" data-tooltip="Enter the number of copies">
                <label for="quantity">Quantity <i class="material-icons tiny tooltipped" data-tooltip="Number of copies">help_outline</i></label>
                <span class="helper-text">How many copies are available?</span>
              </div>
              <div class="file-field input-field">
                <div class="btn" style="background:var(--accent);">
                  <span><i class="material-icons">image</i></span>
                  <input type="file" id="cover" accept="image/*" />
                </div>
                <div class="file-path-wrapper">
                  <input class="file-path validate" type="text" placeholder="Upload book cover (optional)">
                </div>
                <span class="helper-text">Optional: Add a cover image for the book.</span>
              </div>
              <button type="submit" class="btn waves-effect waves-light tooltipped" data-tooltip="Save Book"><i class="material-icons left">save</i>Save Book</button>
              <button type="button" id="resetBtn" class="btn grey lighten-1 tooltipped" data-tooltip="Reset form"><i class="material-icons left">refresh</i>Reset</button>
            </form>
          </div>
        </div>
        <div class="card step-card">
          <div class="card-content">
            <span class="card-title"><i class="material-icons left">search</i> Search/Filter Books</span>
            <div class="input-field">
              <input type="text" id="searchInput" placeholder="Search by title, author, ISBN, genre..." class="tooltipped" data-tooltip="Type to search books">
              <label for="searchInput">Search <i class="material-icons tiny tooltipped" data-tooltip="Search books">help_outline</i></label>
              <span class="helper-text">Type a keyword and click Search.</span>
            </div>
            <button id="searchBtn" class="btn waves-effect waves-light tooltipped" data-tooltip="Search books"><i class="material-icons left">search</i>Search</button>
            <button id="clearSearchBtn" class="btn grey lighten-1 tooltipped" data-tooltip="Clear search"><i class="material-icons left">clear</i>Clear</button>
          </div>
        </div>
        <div class="card step-card">
          <div class="card-content">
            <span class="card-title"><i class="material-icons left">list</i> Book List</span>
            <table id="booksTable" class="striped responsive-table">
              <thead>
                <tr>
                  <th>Cover</th>
                  <th>Title</th>
                  <th>Author</th>
                  <th>ISBN</th>
                  <th>Genre</th>
                  <th>Quantity</th>
                  <th class="admin-only">Actions <i class="material-icons tiny tooltipped" data-tooltip="Edit or delete book">help_outline</i></th>
                </tr>
              </thead>
              <tbody>
                <!-- Book rows go here -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="col s12 m4">
        <div class="card-panel">
          <b>Need help?</b> Click the <b>?</b> button below or hover over any <i class="material-icons tiny">help_outline</i> icon!
        </div>
      </div>
    </div>
  </div>
  <div class="fixed-action-btn">
    <a class="btn-floating btn-large tooltipped" data-tooltip="Help & FAQ" href="#helpModal">
      <i class="material-icons">help_outline</i>
    </a>
  </div>
  <div id="helpModal" class="modal">
    <div class="modal-content">
      <h5>Help & FAQ</h5>
      <ul class="collection">
        <li class="collection-item">To add a book, fill in the form and click <b>Save Book</b>.</li>
        <li class="collection-item">To search, type a keyword and click <b>Search</b>.</li>
        <li class="collection-item">Admins can edit or delete books using the actions column.</li>
        <li class="collection-item">Hover over any <i class="material-icons tiny">help_outline</i> icon for more info.</li>
        <li class="collection-item">For more help, contact your librarian or admin.</li>
      </ul>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close btn-flat">Close</a>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script type="module" src="js/firebase.js"></script>
  <script type="module" src="js/books.js"></script>
  <script type="module">
    import { auth, db } from './js/firebase.js';
    import { doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    import { logout, highlightActiveNav } from './js/utils.js';
    document.addEventListener('DOMContentLoaded', function() {
      var modals = document.querySelectorAll('.modal');
      M.Modal.init(modals);
      var tooltipped = document.querySelectorAll('.tooltipped');
      M.Tooltip.init(tooltipped);
    });
    auth.onAuthStateChanged(async (user) => {
      if (user) {
        const userDoc = await getDoc(doc(db, "users", user.uid));
        const role = userDoc.exists() ? userDoc.data().role : null;
        if (role !== "admin") {
          document.querySelectorAll('.admin-only').forEach(el => el.style.display = 'none');
        }
      }
    });
    document.getElementById('logoutBtn').onclick = logout;
    highlightActiveNav();
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const navLinks = document.querySelectorAll('#nav-mobile a');
      const current = window.location.pathname.split('/').pop();
      navLinks.forEach(link => {
        if(link.getAttribute('href') === current) {
          link.parentElement.classList.add('active');
        }
      });
    });
  </script>
  <script src="js/navHighlight.js"></script>
</body>
</html> 